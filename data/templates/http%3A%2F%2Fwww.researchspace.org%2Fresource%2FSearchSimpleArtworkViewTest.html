  <semantic-context repository='ephedra'>
<semantic-query query='
SELECT ?token WHERE{
  BIND(REPLACE("[[urlParam "keyword"]]","(?<!^)(?<!\\s)\\s+(?!\\s+)(?!$)", " AND ") as ?token)
}
'
template="{{>addAndTemplate}}"
>
<template id="addAndTemplate">

<div>
    <semantic-search-query-keyword
placeholder='You searched for [[urlParam "keyword"]], but you can search for anything!'
domain="<http://www.cidoc-crm.org/cidoc-crm/E22_Man-Made_Object>"
default-query='
PREFIX solr: <http://custom.solr/ontology#>
  SELECT ?subject WHERE {
    SERVICE <http://www.researchspace.org/resource/system/service/custom#solrworks>{
      ?solrApi solr:setQuery "{{bindings.0.token.value}}";
                solr:setDefType "dismax";
                solr:setFilter "id";
                solr:setRowsNumber [[urlParam "selectedlimit"]];
                solr:hasResults ?subject
    }
  }
  '
query='
SELECT ?nothing WHERE{
  ?nothing a <http://this_is_hidden_and_will_never_run>
}
'
class="hiddenSearchbar"
></semantic-search-query-keyword>

<div class="row">
<bs-col
  lg="3"
  md="4"
  sm="5"
  class="fade-in-fwd filters-container"
  style="margin-top: 8px"
  id="artwork-filter-search"
>
<bs-panel id="filter-panel" header="Filters"  collapsible="true" default-expanded="true">
  <semantic-search-facet open-by-default="true"></semantic-search-facet>
</bs-panel>
</bs-col>
<bs-col lg="9" md="8" sm="7">
  <semantic-search-result-holder>
    <div>
      <mp-event-target-template-render
      id="event-target-tables"
      template="{{> tableEventTargetTemplate}}"
    >
      <template id="tableEventTargetTemplate">
    <semantic-search-result>
      <semantic-query
        id="view-more"
        query='SELECT ?keywords WHERE {
          BIND(REPLACE(str("[[urlParam "keyword"]]"),"\\+"," ") as ?keywords)
        }'
        template="{{>currentSearchText}}"
      >
        <template id="currentSearchText">
          <h2>
            Searched in artworks for:
            <i>{{bindings.0.keywords.value}}</i>
          </h2>
        </template>
      </semantic-query>
      <semantic-query
        id="view-more"
        query='SELECT (COUNT(?subject) as ?count) WHERE {
          {{#ifCond withImages "===" "true"}}
            ?subject fr:Work_depicted_by_Photo ?photo.
            ?photo crm:P129i_is_subject_of ?fullsizeImgUrl.
          {{/ifCond}}
        }LIMIT 1'
        template="{{>currentResultCount}}"
      >
        <template id="currentResultCount">
          <h2>
            {{#ifCond bindings.0.count.value "==" 10000}}
            Found more than 10000 matches, please refine your search using filters
            {{else}}
              Found {{bindings.0.count.value}} matches
            {{/ifCond}}
          </h2>
        </template>
      </semantic-query>
      <semantic-search-facet-breadcrumbs></semantic-search-facet-breadcrumbs>
      [[> :SearchbarSwitches]]
      <bs-tabs
      default-active-key="1"
      unmount-on-exit="true"
      id="search-results"
      animation="false"
      class="tabs-right"
    >
      <bs-tab event-key="1" title="List">
        <div id='artwork-filter-search-inline'>
        <semantic-table
        id="grid-result"
        query='SELECT ?subject  WHERE {
          {{#ifCond withImages "===" "true"}}
            ?subject fr:Work_depicted_by_Photo ?photo.
            ?photo crm:P129i_is_subject_of ?fullsizeImgUrl.
          {{/ifCond}}
        }LIMIT 100'
        number-of-displayed-rows="{{#if noRows}}{{noRows}}{{else}}10{{/if}}"
        tuple-template="{{> subjectCellTemplate}}"
        options='{"showTableHeading": false, "showFilter":false}'
        no-result-template='[[> :CardNoResult ]]'
      >
        <template id="subjectCellTemplate">
          [[> :CardArtwork]]
        </template>
      </div>
      </semantic-table>
    </bs-tab>
      <bs-tab event-key="2" title="Tabular">
        <div id="tableView">
          [[> :SearchResultTableWorkTest]]
        </div>
      </bs-tab>
      </bs-tabs>
    </semantic-search-result>
    [[> :NumberOfRowsSelector]]
  </template>
    </mp-event-target-template-render>
    </div>
  </semantic-search-result-holder>
</bs-col>
</div>
</div>

</template>
</semantic-query>
</semantic-context>

